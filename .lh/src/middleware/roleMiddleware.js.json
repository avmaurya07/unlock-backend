{
    "sourceFile": "src/middleware/roleMiddleware.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1766174321504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766923090728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,26 @@\n-module.exports = (...allowedRoles) => {\n-    return (req, res, next) => {\n-      if (!allowedRoles.includes(req.user.role)) {\n-        return res.status(403).json({ message: \"Access denied\" });\n+module.exports = function role(requiredRole) {\n+  return (req, res, next) => {\n+    try {\n+      if (!req.user) {\n+        return res.status(401).json({\n\\ No newline at end of file\n+          success: false,\n+          message: \"Unauthorized\",\n+        });\n       }\n+\n+      if (req.user.role !== requiredRole) {\n+        return res.status(403).json({\n+          success: false,\n+          message: \"Forbidden: Access denied\",\n+        });\n+      }\n+\n       next();\n-    };\n+    } catch (err) {\n+      return res.status(500).json({\n+        success: false,\n+        message: \"Server error in role check\",\n+      });\n+    }\n   };\n-  \n+};\n"
                },
                {
                    "date": 1767936072239,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,4 +23,5 @@\n       });\n     }\n   };\n };\n+\n"
                },
                {
                    "date": 1767936321127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,4 +23,5 @@\n       });\n     }\n   };\n };\n+\n"
                },
                {
                    "date": 1767936348592,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,9 @@\n         return res.status(401).json({\n           success: false,\n           message: \"Unauthorized\",\n         });\n+        \n       }\n \n       if (req.user.role !== requiredRole) {\n         return res.status(403).json({\n"
                },
                {
                    "date": 1767936363247,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n module.exports = function role(requiredRole) {\n   return (req, res, next) => {\n+    \n     try {\n       if (!req.user) {\n         return res.status(401).json({\n           success: false,\n"
                }
            ],
            "date": 1766174321504,
            "name": "Commit-0",
            "content": "module.exports = (...allowedRoles) => {\n    return (req, res, next) => {\n      if (!allowedRoles.includes(req.user.role)) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      next();\n    };\n  };\n  "
        }
    ]
}